---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "packetfabric_cloud_router_bgp_session Resource - terraform-provider-packetfabric"
subcategory: ""
description: |-
  
---

# packetfabric_cloud_router_bgp_session (Resource)

The BGP session information for a cloud router connection. 

For information specific to each cloud provider, see [the PacketFabric cloud router BGP documentation](https://docs.packetfabric.com/cr/bgp/).

->**Note:** When creating a BGP session, ensure you are also adding the associated prefixes.

## Example Usage

```terraform
resource "packetfabric_cloud_router" "cr1" {
  provider = packetfabric
  asn      = var.pf_cr_asn
  name     = var.pf_cr_name
  capacity = var.pf_cr_capacity
  regions  = var.pf_cr_regions
}

resource "packetfabric_cloud_router_connection_aws" "crc1" {
  provider    = packetfabric
  circuit_id  = packetfabric_cloud_router.cr1.id
  maybe_nat   = var.pf_crc_maybe_nat
  maybe_dnat  = var.pf_crc_maybe_dnat
  description = var.pf_crc_description
  pop         = var.pf_crc_pop
  zone        = var.pf_crc_zone
  is_public   = var.pf_crc_is_public
  speed       = var.pf_crc_speed
}

# Example maybe_nat set to false
resource "packetfabric_cloud_router_bgp_session" "cr_bgp1" {
  provider       = packetfabric
  circuit_id     = packetfabric_cloud_router.cr1.id
  connection_id  = packetfabric_cloud_router_connection_aws.crc1.id
  address_family = var.pf_crbs_af
  multihop_ttl   = var.pf_crbs_mhttl
  remote_asn     = var.pf_crbs_rasn
  orlonger       = var.pf_crbs_orlonger
  remote_address = var.pf_crbs_remoteaddr
  l3_address     = var.pf_crbs_l3addr
  md5            = var.pf_crbs_md5
  prefixes {
    prefix = var.pf_crbp_pfx00
    type   = var.pf_crbp_pfx00_type
    order  = var.pf_crbp_pfx00_order
  }
  prefixes {
    prefix = var.pf_crbp_pfx01
    type   = var.pf_crbp_pfx01_type
    order  = var.pf_crbp_pfx01_order
  }
}

# Example maybe_nat set to true (source NAT)
resource "packetfabric_cloud_router_bgp_session" "cr_bgp1" {
  provider       = packetfabric
  circuit_id     = packetfabric_cloud_router.cr1.id
  connection_id  = packetfabric_cloud_router_connection_aws.crc1.id
  address_family = var.pf_crbs_af
  multihop_ttl   = var.pf_crbs_mhttl
  remote_asn     = var.pf_crbs_rasn
  orlonger       = var.pf_crbs_orlonger
  remote_address = var.pf_crbs_remoteaddr
  l3_address     = var.pf_crbs_l3addr
  md5            = var.pf_crbs_md5
  nat {
    direction       = "input" # or output
    nat_type        = "overload"
    pre_nat_sources = var.pf_crbs_pre_nat_sources # e.g. ["10.1.1.0/24", "10.1.2.0/24", "10.1.3.0/24"]
    pool_prefixes   = var.pf_crbs_pool_prefixes   # e.g. ["192.168.1.50/32", "192.168.1.51/32"]
  }
  prefixes {
    prefix = var.pf_crbp_pfx00
    type   = var.pf_crbp_pfx00_type
    order  = var.pf_crbp_pfx00_order
  }
  prefixes {
    prefix = var.pf_crbp_pfx01
    type   = var.pf_crbp_pfx01_type
    order  = var.pf_crbp_pfx01_order
  }
}

# Example maybe_dnat set to true (destination NAT)
resource "packetfabric_cloud_router_bgp_session" "cr_bgp1" {
  provider       = packetfabric
  circuit_id     = packetfabric_cloud_router.cr1.id
  connection_id  = packetfabric_cloud_router_connection_aws.crc1.id
  address_family = var.pf_crbs_af
  multihop_ttl   = var.pf_crbs_mhttl
  remote_asn     = var.pf_crbs_rasn
  orlonger       = var.pf_crbs_orlonger
  remote_address = var.pf_crbs_remoteaddr
  l3_address     = var.pf_crbs_l3addr
  md5            = var.pf_crbs_md5
  nat {
    nat_type = "inline_dnat"
    dnat_mappings {
      private_prefix = var.pf_crbs_private_prefix1
      public_prefix  = var.pf_crbs_public_prefix1
    }
    dnat_mappings {
      private_prefix     = var.pf_crbs_private_prefix2
      public_prefix      = var.pf_crbs_public_prefix2
      conditional_prefix = var.pf_crbs_conditional_prefix2 # must be a subnet of private_prefix
    }
  }
  prefixes {
    prefix = var.pf_crbp_pfx00
    type   = var.pf_crbp_pfx00_type
    order  = var.pf_crbp_pfx00_order
  }
  prefixes {
    prefix = var.pf_crbp_pfx01
    type   = var.pf_crbp_pfx01_type
    order  = var.pf_crbp_pfx01_order
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `address_family` (String) Whether this instance is IPv4 or IPv6. At this time, only IPv4 is supported.

	Enum: "v4" "v6"
- `circuit_id` (String) Circuit ID of the target cloud router. This starts with "PF-L3-CUST-".
- `connection_id` (String) The circuit ID of the connection associated with the BGP session. This starts with "PF-L3-CON-".
- `prefixes` (Block Set, Min: 1) The list of BGP prefixes (see [below for nested schema](#nestedblock--prefixes))
- `remote_asn` (Number) The cloud-side ASN.

### Optional

- `as_prepend` (Number) The BGP prepend value for this instance. Deprecated.
- `bfd_interval` (Number) If you are using BFD, this is the interval (in milliseconds) at which to send test packets to peers.

	Available range is 3 through 30000.
- `bfd_multiplier` (Number) If you are using BFD, this is the number of consecutive packets that can be lost before BFD considers a peer down and shuts down BGP.

	Available range is 2 through 16.
- `community` (Number) The BGP community for this instance. Deprecated.
- `disabled` (Boolean) Whether this BGP session is disabled. Default is false.
- `l3_address` (String) The L3 address of this instance. Not used for Azure connections. Required for all other CSP.
- `local_preference` (Number) The local preference for this instance. When the same route is received in multiple locations, those with a higher local preference value are preferred by the cloud router. Deprecated.
- `md5` (String) The MD5 value of the authenticated BGP sessions. Required for AWS.
- `med` (Number) The Multi-Exit Discriminator of this instance. When the same route is advertised in multiple locations, those with a lower MED are preferred by the peer AS. Deprecated.
- `multihop_ttl` (Number) The TTL of this session. The default is `1`. For Google Cloud connections, see [the PacketFabric doc](https://docs.packetfabric.com/cr/bgp/bgp_google/#ttl).
- `nat` (Block Set) (see [below for nested schema](#nestedblock--nat))
- `orlonger` (Boolean) Whether to use exact match or longer for all prefixes.
- `primary_subnet` (String) Currently for Azure use only. Provide this as the primary subnet when creating an Azure cloud router connection.
- `remote_address` (String) The cloud-side router peer IP. Not used for Azure connections. Required for all other CSP.
- `secondary_subnet` (String) Currently for Azure use only. Provide this as the secondary subnet when creating an Azure cloud router connection.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--prefixes"></a>
### Nested Schema for `prefixes`

Required:

- `prefix` (String) The actual IP Prefix of this instance.
- `type` (String) Whether this prefix is in or out.

Optional:

- `as_prepend` (Number) The BGP prepend value of this prefix. It is used when type = out.
- `local_preference` (Number) The local_preference of this prefix. It is used when type = in.
- `match_type` (String) The match type of this prefix.
- `med` (Number) The MED of this prefix. It is used when type = out.
- `order` (Number) The order of this prefix against the others.


<a id="nestedblock--nat"></a>
### Nested Schema for `nat`

Optional:

- `direction` (String) The direction of the NAT connection. Output is the default.
		Enum: output, input.
- `dnat_mappings` (Block Set) (see [below for nested schema](#nestedblock--nat--dnat_mappings))
- `nat_type` (String) The NAT type of the NAT connection. Overload is the default.
		Enum: overload, inline_dnat.
- `pool_prefixes` (List of String) If using NAT, all prefixes that are NATed on this connection will be translated to the pool prefix address.

	Example: 10.0.0.0/32
- `pre_nat_sources` (List of String) If using NAT, this is the prefixes from the cloud that you want to associate with the NAT pool.

	Example: 10.0.0.0/24

<a id="nestedblock--nat--dnat_mappings"></a>
### Nested Schema for `nat.dnat_mappings`

Required:

- `private_prefix` (String) The private prefix of this DNAT mapping.
- `public_prefix` (String) The public prefix of this DNAT mapping.

Optional:

- `conditional_prefix` (String) The conditional prefix prefix of this DNAT mapping.


## Import

Import a Cloud Router BGP session using the BGP ID for the session.

```bash
terraform import packetfabric_cloud_router_bgp_session.cr_bgp1 779881f7-b0ae-4794-8183-1a8ffd9ee777
```