---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "packetfabric_cloud_router_bgp_session Resource - terraform-provider-packetfabric"
subcategory: ""
description: |-
  
---

# packetfabric_cloud_router_bgp_session (Resource)

The BGP session information for a cloud router connection. 

For information specific to each cloud provider, see [the PacketFabric cloud router BGP documentation](https://docs.packetfabric.com/cr/bgp/).

->**Note:** When creating a BGP session, ensure you are also adding the associated prefixes. For Azure, only specify either the `primary_subnet` or the `secondary_subnet`.

## Example Usage

```terraform
resource "packetfabric_cloud_router" "cr1" {
  provider = packetfabric
  asn      = 4556
  name     = "hello world"
  capacity = "10Gbps"
  regions  = ["US"]
  labels   = ["terraform", "dev"]
}

resource "packetfabric_cloud_router_connection_aws" "crc1" {
  provider    = packetfabric
  circuit_id  = packetfabric_cloud_router.cr1.id
  maybe_nat   = false
  description = "hello world"
  pop         = "PDX2"
  zone        = "A"
  is_public   = false
  speed       = "1Gbps"
  labels      = ["terraform", "dev"]
}

# Example maybe_nat set to false
resource "packetfabric_cloud_router_bgp_session" "cr_bgp1" {
  provider       = packetfabric
  circuit_id     = packetfabric_cloud_router.cr1.id
  connection_id  = packetfabric_cloud_router_connection_aws.crc1.id
  remote_asn     = 64535
  remote_address = "169.254.247.41/30"  # AWS side
  l3_address     = "169.254.247.42/30" # PF side
  prefixes {
    prefix = "10.1.1.0/24"
    type   = "out" # Allowed Prefixes to Cloud
  }
  prefixes {
    prefix = "10.1.2.0/24"
    type   = "out" # Allowed Prefixes to Cloud
  }
  prefixes {
    prefix = "172.16.1.0/24"
    type   = "in" # Allowed Prefixes from Cloud
  }
  prefixes {
    prefix = "172.16.2.0/24"
    type   = "in" # Allowed Prefixes from Cloud
  }
}

# Example maybe_nat set to true (source NAT)
resource "packetfabric_cloud_router_bgp_session" "cr_bgp1" {
  provider       = packetfabric
  circuit_id     = packetfabric_cloud_router.cr1.id
  connection_id  = packetfabric_cloud_router_connection_aws.crc1.id
  remote_asn     = 64535
  remote_address = "169.254.247.41/30"  # AWS side
  l3_address     = "169.254.247.42/30" # PF side
  nat {
    direction       = "input" # or output
    nat_type        = "overload"
    pre_nat_sources = ["10.1.1.0/24", "10.1.2.0/24", "10.1.3.0/24"]
    pool_prefixes   = ["192.168.1.50/32", "192.168.1.51/32"]
  }
  prefixes {
    prefix = "172.16.1.0/24"
    type   = "out" # Allowed Prefixes to Cloud
  }
  prefixes {
    prefix = "10.1.1.0/24"
    type   = "in" # Allowed Prefixes from Cloud
  }
}

# Example maybe_dnat set to true (destination NAT)
resource "packetfabric_cloud_router_bgp_session" "cr_bgp1" {
  provider       = packetfabric
  circuit_id     = packetfabric_cloud_router.cr1.id
  connection_id  = packetfabric_cloud_router_connection_aws.crc1.id
  remote_asn     = 64535
  remote_address = "169.254.247.41/30"  # AWS side
  l3_address     = "169.254.247.42/30" # PF side
  nat {
    nat_type = "inline_dnat"
    dnat_mappings {
      private_prefix = "10.1.1.0/24"
      public_prefix  = "1.2.3.4/32"
    }
    dnat_mappings {
      private_prefix     = "172.16.0.0/16"
      public_prefix      = "1.2.3.5/32"
      conditional_prefix = "172.16.1.0/24" # must be a subnet of private_prefix
    }
  }
  prefixes {
    prefix = "172.16.1.0/24"
    type   = "out" # Allowed Prefixes to Cloud
  }
  prefixes {
    prefix = "10.1.1.0/24"
    type   = "in" # Allowed Prefixes from Cloud
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `circuit_id` (String) Circuit ID of the target cloud router. This starts with "PF-L3-CUST-".
- `connection_id` (String) The circuit ID of the connection associated with the BGP session. This starts with "PF-L3-CON-".
- `prefixes` (Block Set, Min: 1) The list of BGP prefixes (see [below for nested schema](#nestedblock--prefixes))
- `remote_asn` (Number) The cloud-side ASN.

### Optional

- `address_family` (String) Whether this instance is IPv4 or IPv6. At this time, only IPv4 is supported.

	Enum: "v4" "v6" Defaults: v4
- `as_prepend` (Number) The BGP prepend value for this instance. It is used when type = out.

	Available range is 1 through 5.
- `bfd_interval` (Number) If you are using BFD, this is the interval (in milliseconds) at which to send test packets to peers.

	Available range is 3 through 30000.
- `bfd_multiplier` (Number) If you are using BFD, this is the number of consecutive packets that can be lost before BFD considers a peer down and shuts down BGP.

	Available range is 2 through 16.
- `disabled` (Boolean) Whether this BGP session is disabled. Defaults: false
- `l3_address` (String) The L3 address of this instance. Not used for Azure connections. Required for all other CSP.
- `local_preference` (Number) The local preference for this instance. When the same route is received in multiple locations, those with a higher local preference value are preferred by the cloud router. It is used when type = in.

	Available range is 1 through 4294967295.
- `md5` (String) The MD5 value of the authenticated BGP sessions. Required for AWS.
- `med` (Number) The Multi-Exit Discriminator of this instance. When the same route is advertised in multiple locations, those with a lower MED are preferred by the peer AS. It is used when type = out.

	Available range is 1 through 4294967295.
- `multihop_ttl` (Number) The TTL of this session. For Google Cloud connections, see [the PacketFabric doc](https://docs.packetfabric.com/cr/bgp/bgp_google/#ttl).

	Available range is 1 through 4. Defaults: 1
- `nat` (Block Set, Max: 1) Translate the source or destination IP address. (see [below for nested schema](#nestedblock--nat))
- `orlonger` (Boolean) Whether to use exact match or longer for all prefixes. Defaults: false
- `primary_subnet` (String) Currently for Azure use only. Provide this as the primary subnet when creating the primary Azure cloud router connection.
- `remote_address` (String) The cloud-side router peer IP. Not used for Azure connections. Required for all other CSP.
- `secondary_subnet` (String) Currently for Azure use only. Provide this as the secondary subnet when creating the secondary Azure cloud router connection.
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--prefixes"></a>
### Nested Schema for `prefixes`

Required:

- `prefix` (String) The actual IP Prefix of this instance.
- `type` (String) Whether this prefix is in (Allowed Prefixes from Cloud) or out (Allowed Prefixes to Cloud).
		Enum: in, out.

Optional:

- `as_prepend` (Number) The BGP prepend value of this prefix. It is used when type = out.

	Available range is 1 through 5.
- `local_preference` (Number) The local_preference of this prefix. It is used when type = in.

	Available range is 1 through 4294967295.
- `match_type` (String) The match type of this prefix.

	Enum: `"exact"` `"orlonger"` Defaults: exact
- `med` (Number) The MED of this prefix. It is used when type = out.

	Available range is 1 through 4294967295.


<a id="nestedblock--nat"></a>
### Nested Schema for `nat`

Optional:

- `direction` (String) If using NAT overload, the direction of the NAT connection. 
		Enum: output, input. Defaults: output
- `dnat_mappings` (Block Set) Translate the destination IP address. (see [below for nested schema](#nestedblock--nat--dnat_mappings))
- `nat_type` (String) The NAT type of the NAT connection, source NAT (overload) or destination NAT (inline_dnat). 
		Enum: overload, inline_dnat. Defaults: overload
- `pool_prefixes` (List of String) If using NAT overload, all prefixes that are NATed on this connection will be translated to the pool prefix address.

	Example: 10.0.0.0/32
- `pre_nat_sources` (List of String) If using NAT overload, this is the prefixes from the cloud that you want to associate with the NAT pool.

	Example: 10.0.0.0/24

<a id="nestedblock--nat--dnat_mappings"></a>
### Nested Schema for `nat.dnat_mappings`

Required:

- `private_prefix` (String) The private prefix of this DNAT mapping.
- `public_prefix` (String) The public prefix of this DNAT mapping.

Optional:

- `conditional_prefix` (String) The conditional prefix prefix of this DNAT mapping.



<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `read` (String)
- `update` (String)




## Import

Import a Cloud Router BGP session using its corresponding BGP UUID, the ID of the Cloud Router Connection and Cloud Router it is associated with, in the format `<cloud router ID>:<cloud router connection ID>:<BGP session UUID>`.

You can find the BGP session UUID in the PacketFabric portal under the Cloud Router Connection details.


```bash
terraform import packetfabric_cloud_router_bgp_session.cr_bgp1 PF-L3-CUST-1700239:PF-L3-CON-2980512:779881f7-b0ae-4794-8183-1a8ffd9ee777
```